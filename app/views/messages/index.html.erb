<div class= "m-5 container">
  <div class="row">
    <div class="col-4">
      <p>Your Messages with: </p>
       <% @conversations.each do |conversation| %>
       <% if conversation.sender_id == current_user.id ||      conversation.recipient_id == current_user.id %>
        <% if conversation.sender_id == current_user.id %>
          <% recipient = User.find(conversation.recipient_id) %>
        <% else %>
          <% recipient = User.find(conversation.sender_id) %>
        <% end %>
        <ul>
          <li><%= link_to recipient.first_name,   conversation_messages_path(conversation)%></li>
        </ul>
       <% end %>
      <% end %>
    </div>
    <div class="col-8">
      <div class="bg-white">
        <% if @over_ten %>
         <%= link_to 'Show Previous', '?m=all' %>
        <% end %>
        <% @messages.each do |message| %>
          <% if message.user %>
            <div class="p-3 <%= message.user == current_user ? "text-right" : "text-left" %>">
              <% if message.user.photo.attached? %>
                <%= cl_image_tag message.user.photo.key, class: "avatar" %>
              <% else %>
                <%= image_tag "user.png", class: "avatar" %>
              <% end %>
              <span class= "rounded p-3 <%= message.user == current_user ? "bg-primary" : "bg-dark" %>"> <%= message.body %> </span>
            </div>
          <%end %>


        <%end%>
        <div class ="message-form">
          <%= form_for [@conversation, @message], html: {class: "ui reply form"} do |f| %>
            <div class="m-3 field">
              <%= f.text_area :body, class: "form-control" %>
            </div>
              <%= f.text_field :user_id, value: current_user.id, type: "hidden" %>
           <div>
             <%= f.submit "Send a message", class: "m-3 ui blue labeled submit icon button" %>
           </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>




